import{RectPath as e,Shape as t,error as a,Component as i}from"@hatiolab/things-scene";import s from"bwip-js";import"underscore";const h={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"select",label:"symbol",name:"symbol",property:{options:["code11","code39","code93","code128","codebar","ean128","ean13","ean8","qrcode","datamatrix","industrial2of5","interleaved2of5","msi","planet","postnet","upca","upce","pdf417","isbn"]}},{type:"checkbox",label:"monochrome",name:"monochrome"},{type:"checkbox",label:"show-text",name:"showText"}],"value-property":"text"},n=["symbol","text","showText","height","width"];class o extends(e(t)){static get nature(){return h}get canvas(){return this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.style.display="none",this._canvas.height=1,this._canvas.width=1),this._canvas}dispose(){super.dispose()}ready(){super.ready(),this.buildImage()}buildImage(){if(!this._image){var{symbol:e,text:t,width:a,height:i,includetext:h,textAlign:n}=this.state;this.canvas.width=a,this.canvas.height=i,s(this.canvas,{bcid:e,text:t,height:i,width:a,includetext:h,textxalign:n},(e,t)=>{e||(this._image=t,this.invalidate())})}}render(e){var{left:t=0,top:i=0,width:s=0,height:h=10}=this.state;try{this._image&&e.drawImage(this._image,t,i,s,h)}catch(e){a(e)}}drawText(){}onchange(e){n.every(t=>!(t in e)||(delete this._image,this.buildImage(),!1))}}i.register("barcode",o);export default[o];
